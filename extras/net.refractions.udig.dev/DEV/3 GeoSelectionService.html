<html>
    <head>
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="../book.css" type="text/css" />
        <title>UDIG Developer Guide : 3 GeoSelectionService</title>
    </head>
    <body BGCOLOR="#FFFFFF">
       <!-- UDIG Developer Guide : 3 GeoSelectionService -->
       <h1>3 GeoSelectionService</h1>

       <h1><a name="3GeoSelectionService-GeoSelectionService."></a>GeoSelectionService.</h1>

<h2><a name="3GeoSelectionService-Whatisthis%3F"></a>What is this?</h2>

<p><tt>GeoSelectionService</tt> is an UDIG object service for geographical information selection management and interoperability of various application parts through unified processing unit. </p>

<p>In Eclipse RCP applications the standard workbench selection service is available for providers and listeners to bind each other through well defined API hiding implementation specifics. The workbench selection service is general and especially used in structured viewers to organize user selections and listeners responsible for the selection processing. It is not fully appropriate for management of selection of distinct geographical information on the map since does not bring the functionality of multiple selection providers (various modal tools being able to make selections with different semantics) and persistent storage has been made across switching of maps.</p>

<p><tt>GeoSelectionService</tt> follows the paradigm of standard workbench selection service and brings mentioned functionality for the persistent management of multiple selections of geographical information/objects on the maps in different contexts.</p>

<h2><a name="3GeoSelectionService-Thearchitecture"></a>The architecture</h2>

<p>The <tt>GeoSelectionService</tt> API is contained in package <tt>net.refractions.udig.project.geoselection</tt>. Like <tt>ISelection</tt> interface works for workbench selection service keeping selected objects, <tt>IGeoSelection</tt> gives a value for <tt>GeoSelectionService</tt>. The one advantage of the <tt>IGeoSelection</tt> is that it is <tt>IAdaptable</tt> and implementations can be really specific hiding all details behind <tt>IAdaptable</tt> interface. Listeners donât really need to know the real implementation of <tt>IGeoSelection</tt> in most cases while working with <tt>IAdaptable.getAdapter(Class)</tt> method to extract selected objects of the type they are interested in.</p>

<p><font color="red"><tt>IGeoSelection</tt> is still under design.</font></p>

<p><tt>GeoSelectionService</tt> is a just singleton point of access like Display in SWT world. It contains multiple selection managers implementing <tt>IGeoSelectionManager</tt> interface. The UDIG platform contains the main selection manager:<br/>
<tt>PlatformGeoSelectionManager implements IGeoSelectionManager</tt></p>

<p>It is available from <tt>GeoSelectionService.getDefault().getPlatformSelectionManager().</tt></p>

<p>The functionality of <tt>PlatformGeoSelectionManager</tt> is based of the currently active <tt>MapEditor</tt> with an active <tt>IMap</tt> object. <tt>IGeoSelections</tt> can be made as by modal tools like standard selection tools or programmatically from any piece of code.</p>

<p>The paradigm of <tt>GeoSelectionService</tt> brings the next items:<br/>
Multiple <tt>IGeoSelectionManagers</tt> can be registered with <tt>GeoSelectionService</tt> to serve specific needs of the developers. The default <tt>IGeoSelectionManager</tt> is an implementation <tt>PlatformGeoSelectionManager</tt> available from <tt>GeoSelectionService.getDefault().getPlatformSelectionManager()</tt>.<br/>
<tt>IGeoSelectionManager</tt> supports multiple <tt>IGeoSelections</tt>: each of them in the specified context. The context defines the domain of substitution policy for the <tt>IGeoSelection</tt>. The substitution policy determines the scope where only one <tt>IGeoSelection</tt> can be made and be active and persistent. The <tt>IGeoSelection</tt> being made in a context ârewritesâ the previous <tt>IGeoSelection</tt> in the same .<br/>
<tt>IGeoSelectionManager</tt> supports notification of all registered listeners when any new <tt>IGeoSelection</tt> is being made with a <tt>GeoSelectionChangedEvent</tt>.<br/>
<tt>IGeoSelectionManager</tt> supports providing the iteration capability through all currently made and persisted <tt>IGeoSelections</tt> in their unique contexts.</p>


<h2><a name="3GeoSelectionService-Usecases"></a>Use cases</h2>

<p>The modal selection tool creates a Filter-based selection of multiple features: <tt>IGeoSelection</tt> implementation will be adaptable to <tt>Filter, ILayer</tt> where the selection is made and the object is passed to the <tt>PlatformGeoSelectionManager</tt>. All listeners will get an event with old selection object, new selection object and other necessary information. Feature editor can listen PlatformGeoSelectionManager to respond on the event: to create an UI for the editing of attributes of multiple features described by Filter.</p>

<p>When the <tt>FidFilter</tt> is used for one feature the <tt>IGeoSelection</tt> can adapt to an instance of <tt>Feature</tt>  and a corresponding editor can create an UI for editing of Feature attributes.</p>

<p>The context menu being opened on the <tt>MapEditor</tt> surface can ask the <tt>PlatformGeoSelectionManager</tt> and iterate through all currently available <tt>IGeoSelections</tt> to create necessary items in the menu. For this purpose the new small framework is desired to configure context menu items based on <tt>IGeoSelections</tt> in <tt>GeoSelectionService</tt> through RCP extension point mechanism in future.</p>



<small>
  (c) Copyright (c) 2004-2008 Refractions Research Inc. and others.<br>
  <a href="http://udig.refractions.net/confluence/pages/viewpage.action?pageId=9917">[wiki]</a>
</small>
    </body>
</html>