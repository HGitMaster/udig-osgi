<html>
    <head>
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" href="../book.css" type="text/css" />
        <title>UDIG Developer Guide : FeatureSourceOp Tutorial</title>
    </head>
    <body BGCOLOR="#FFFFFF">
       <!-- UDIG Developer Guide : FeatureSourceOp Tutorial -->
       <h1>FeatureSourceOp Tutorial</h1>

       
<h2><a name="FeatureSourceOpTutorial-FeatureSourceOpTutorial"></a>FeatureSourceOp Tutorial</h2>

<p>IOps are included in the context menu in the Local Registry.  Open Local Registry Dialog.  Expand an entry and right click on the child item.  A menu will appear with a Count item.  The count item is a FeatureSourceOp and is the same Operation that is created by this tutorial.  After this tutorial an addition Count item should appear in the Menu, unless you change the name of the extension in the plugin.xml.</p>

<p>This tutorial creates a simple FeatureSourceOp implementation that counts all the features in a FeatureSource and displays the features in a dialog.</p>

<p>In a eclipse plugin the following lines must be added to the plugin.xml file:</p>

<div class="code panel" style="border-style: solid;border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>plugin.xml fragment</b></div><div class="codeContent panelContent">
<pre class="code-java">&lt;extension
         point=<span class="code-quote">"net.refractions.udig.registry.ui.featureType"</span>&gt;
      &lt;process
            class=<span class="code-quote">"xyz.examplepackage.CountOp"</span>
            name=<span class="code-quote">"Count"</span>&gt;
         &lt;tooltip&gt;
            Counts Features in the selection
         &lt;/tooltip&gt;
      &lt;/process&gt;
   &lt;/extension&gt;</pre>
</div></div>
<p>The xml fragment above declares an extension of the net.refractions.udig.registry.ui.featureType.  The type of operation is a process operation (A child of the &lt;extension&gt; tag is the &lt;process&gt; tag).  The name of the process is Count and the operation class is xyz.examplepackage.CountOp.  The &lt;tooltip&gt; tag provides the plugin with a tooltip, this is optional.</p>

<p>Next the operation class must be defined:</p>

<div class="code panel" style="border-style: solid;border-width: 1px;"><div class="codeHeader panelHeader" style="border-bottom-width: 1px;border-bottom-style: solid;"><b>CountOp.java</b></div><div class="codeContent panelContent">
<pre class="code-java"><span class="code-keyword">public</span> class CountOp <span class="code-keyword">extends</span> FeatureSourceOp {

    /**
     * Counts the features in the feature source
     * 
     * @see net.refractions.udig.registry.ui.FeatureSourceOp#op(org.geotools.data.FeatureSource)
     */
    <span class="code-keyword">public</span> void op( FeatureSource source ) <span class="code-keyword">throws</span> Exception {
        FeatureReader reader=source.getFeatures().reader();
        <span class="code-object">int</span> i=0;
        <span class="code-keyword">while</span>( reader.hasNext()){
            i++;
            reader.next();
        }
        reader.close();
        MessageDialog.openInformation(Display.getDefault().getActiveShell(),
                <span class="code-quote">"Feature Count"</span>, <span class="code-quote">"<span class="code-object">Number</span> of Features: "</span>+i);
    }
}</pre>
</div></div>

<p>Once the plugin is exported (Export-&gt;Deployable plug-ins and features) into the uDig plugin directory and uDig is started, the operation will be loaded.  </p>

<small>
  (c) Copyright (c) 2004-2008 Refractions Research Inc. and others.<br>
  <a href="http://udig.refractions.net/confluence/pages/viewpage.action?pageId=52">[wiki]</a>
</small>
    </body>
</html>